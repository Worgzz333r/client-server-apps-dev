<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity6">
<head>
    <meta charset="UTF-8">
    <title>–ú–æ—ó –Ω–æ—Ç–∞—Ç–∫–∏</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 20px auto;
            padding: 20px;
        }
        .note {
            border: 1px solid #ddd;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
        }
        .actions {
            margin-top: 10px;
        }
        .btn {
            padding: 8px 16px;
            margin-right: 5px;
            text-decoration: none;
            border-radius: 3px;
            display: inline-block;
        }
        .btn-primary {
            background: #007bff;
            color: white;
        }
        .btn-secondary {
            background: #6c757d;
            color: white;
        }
        .btn-danger {
            background: #dc3545;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 3px;
            cursor: pointer;
        }
        .admin-only {
            border-left: 4px solid #ffc107;
        }
        .user-info {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 15px;
        }
    </style>
</head>
<body>
<h1>üìã –ú–æ—ó –Ω–æ—Ç–∞—Ç–∫–∏</h1>

<!-- –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ -->
<div class="user-info">
    –í–∏ —É–≤—ñ–π—à–ª–∏ —è–∫: <strong sec:authentication="name"></strong>
    <span sec:authorize="hasRole('ADMIN')">üëë (–ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä)</span>
    <span sec:authorize="hasRole('USER')">üë§ (–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á)</span>
</div>

<!-- –ö–Ω–æ–ø–∫–∏ –¥—ñ–π (—Ç—ñ–ª—å–∫–∏ –¥–ª—è –∞–¥–º—ñ–Ω—ñ–≤) -->
<div style="margin-bottom: 20px;">
    <a sec:authorize="hasRole('ADMIN')" href="/web/notes/create" class="btn btn-primary">
        ‚ûï –î–æ–¥–∞—Ç–∏ –Ω–æ—Ç–∞—Ç–∫—É
    </a>
    <a href="/logout" class="btn btn-secondary">üö™ –í–∏–π—Ç–∏</a>
    <a href="/" class="btn btn-secondary">üè† –ù–∞ –≥–æ–ª–æ–≤–Ω—É</a>
</div>

<!-- –°–ø–∏—Å–æ–∫ –Ω–æ—Ç–∞—Ç–æ–∫ -->
<div th:if="${notes != null and !notes.empty}">
    <div th:each="note : ${notes}" class="note" th:classappend="${#authorization.expression('hasRole(''ADMIN'')')} ? 'admin-only' : ''">
        <h3 th:text="${note.title}">–ó–∞–≥–æ–ª–æ–≤–æ–∫</h3>
        <p th:text="${note.content}">–¢–µ–∫—Å—Ç –Ω–æ—Ç–∞—Ç–∫–∏...</p>
        <small>–°—Ç–≤–æ—Ä–µ–Ω–æ:
            <span th:text="${#temporals.format(note.createdAt, 'dd.MM.yyyy HH:mm')}">
                –¥–∞—Ç–∞
            </span>
        </small>

        <!-- –ö–Ω–æ–ø–∫–∏ –¥—ñ–π (—Ä—ñ–∑–Ω—ñ –¥–ª—è —Ä—ñ–∑–Ω–∏—Ö —Ä–æ–ª–µ–π) -->
        <div class="actions">
            <!-- –ü–µ—Ä–µ–≥–ª—è–¥ - –¥–ª—è –≤—Å—ñ—Ö -->
            <a th:href="@{'/web/notes/' + ${note.id}}" class="btn btn-primary">
                –ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏
            </a>

            <!-- –†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è - —Ç—ñ–ª—å–∫–∏ –¥–ª—è –∞–¥–º—ñ–Ω—ñ–≤ -->
            <a sec:authorize="hasRole('ADMIN')"
               th:href="@{'/web/notes/edit/' + ${note.id}}"
               class="btn btn-secondary">
                –†–µ–¥–∞–≥—É–≤–∞—Ç–∏
            </a>

            <!-- –í–∏–¥–∞–ª–µ–Ω–Ω—è - —Ç—ñ–ª—å–∫–∏ –¥–ª—è –∞–¥–º—ñ–Ω—ñ–≤ -->
            <form sec:authorize="hasRole('ADMIN')"
                  th:action="@{'/web/notes/delete/' + ${note.id}}"
                  method="post"
                  style="display: inline;">
                <button type="submit"
                        class="btn-danger"
                        onclick="return confirm('–í–∏–¥–∞–ª–∏—Ç–∏ —Ü—é –Ω–æ—Ç–∞—Ç–∫—É?')">
                    –í–∏–¥–∞–ª–∏—Ç–∏
                </button>
            </form>
        </div>
    </div>
</div>

<!-- –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –≤—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å –Ω–æ—Ç–∞—Ç–æ–∫ -->
<div th:if="${notes == null or notes.empty}" style="text-align: center; padding: 40px;">
    <h3>üòî –ù–µ–º–∞—î –Ω–æ—Ç–∞—Ç–æ–∫</h3>
    <p sec:authorize="hasRole('ADMIN')">
        –°—Ç–≤–æ—Ä—ñ—Ç—å —Å–≤–æ—é –ø–µ—Ä—à—É –Ω–æ—Ç–∞—Ç–∫—É!
        <br>
        <a href="/web/notes/create" class="btn btn-primary">–°—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ—Ç–∞—Ç–∫—É</a>
    </p>
    <p sec:authorize="hasRole('USER')">
        –ù–∞—Ä–∞–∑—ñ –Ω–µ–º–∞—î –¥–æ—Å—Ç—É–ø–Ω–∏—Ö –Ω–æ—Ç–∞—Ç–æ–∫. –ó–≤–µ—Ä–Ω—ñ—Ç—å—Å—è –¥–æ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞.
    </p>
</div>
</body>
</html>